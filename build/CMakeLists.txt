cmake_minimum_required (VERSION 2.6) 
project (Monarqui) 
set (Monarqui_VERSION_MAJOR 1)
set (Monarqui_VERSION_MINOR 0)
SET(CMAKE_MODULE_PATH "${CMAKE_SOURCE_DIR}/../cmake;${CMAKE_MODULE_PATH}")

find_package(PkgConfig REQUIRED)
find_package(ZeroMQ REQUIRED)
find_package(LibXml2 REQUIRED)
find_package(Threads REQUIRED)
find_package(Lua51 REQUIRED)
find_package(Glib REQUIRED)
find_package(GTK2 REQUIRED)

if (GTK2_FOUND)
  message("Found Gtk")
  include_directories(${GTK2_INCLUDE_DIRS})
  link_directories(${GTK2_LIBRARIES})
endif()
if (GLIB_FOUND)
  message("Found Glib")
  include_directories(${GLIB_INCLUDE_DIRS})
  link_directories(${GLIB_LIBRARIES})
endif()
if (ZEROMQ_FOUND)
  message("Found ZeroMQ")
  include_directories(${ZEROMQ_INCLUDE_DIR})
  link_directories(${ZEROMQ_LIBRARIES})
  link_directories(${ZEROMQ_LIBRARY})
endif()
if(LIBXML2_FOUND)
  message("Found LibXML2")
  include_directories(${LIBXML2_INCLUDE_DIR})
  link_directories(${LIBXML2_LIBRARIES})  
endif()
if (THREADS_FOUND)
  message("Found Threads library")
endif()
if (LUA51_FOUND)
  message("Lua 5.1 found")
  include_directories(${LUA_INCLUDE_DIR})
  link_directories(${LUA_LIBRARIES})
endif()
set(monarqui_reactlist_LIBRARIES ${LIBXML2_DEFINITIONS} ${GLIB_LIBRARIES} ${ZEROMQ_LIBRARIES} ${ZEROMQ_LIBRARY} ${LIBXML2_LIBRARIES} ${LIBXML2_DEFINITIONS} ${LUA_LIBRARIES})
file(GLOB monarqui_common_SOURCES ../src/common/*.c)
file(GLOB monarqui_common_HEADERS ../src/common/*.h)

file(GLOB monarqui_reactlist_SOURCES ../src/reactlist/*.c)
file(GLOB monarqui_reactlist_HEADERS ../src/reactlist/*.h)

set(monarqui_cli_LIBRARIES ${monarqui_reactlist_LIBRARIES})
file(GLOB monarqui_cli_SOURCES ${monarqui_common_SOURCES} ${monarqui_reactlist_SOURCES} ../src/cli/*.c)
file(GLOB monarqui_cli_HEADERS ${monarqui_common_HEADERS} ${monarqui_reactlist_HEADERS} ../src/cli/*.h)

set(monarqui_gui_LIBRARIES ${monarqui_reactlist_LIBRARIES} ${GTK2_LIBRARIES})
file(GLOB monarqui_gui_SOURCES ${monarqui_common_SOURCES} ${monarqui_reactlist_SOURCES} ../src/gui/*.c)
file(GLOB monarqui_gui_HEADERS ${monarqui_common_HEADERS} ${monarqui_reactlist_HEADERS} ../src/gui/*.h)

set(CMAKE_C_FLAGS "-ffunction-sections -fdata-sections")

add_executable (../out/monarqui_cli ${monarqui_cli_SOURCES} ${monarqui_cli_HEADERS})
target_link_libraries(../out/monarqui_cli ${monarqui_cli_LIBRARIES})

add_executable (../out/monarqui_gui ${monarqui_gui_SOURCES} ${monarqui_gui_HEADERS})
target_link_libraries(../out/monarqui_gui ${monarqui_gui_LIBRARIES})
# add_custom_command(TARGET reversi PRE_BUILD COMMAND ./bn.sh)
